<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clay County Master Portal</title>
    <style>
        /* --- 1. GLOBAL LAYOUT (Locked) --- */
        body { margin: 0; padding: 0; background: #121212; color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .my-perfect-layout { display: flex; flex-direction: column; min-height: 100vh; width: 100%; }
        header { background: #1f1f1f; padding: 20px; text-align: center; border-bottom: 3px solid #00ff00; }
        footer { text-align: center; padding: 20px; color: #444; font-size: 0.8rem; margin-top: auto; }

        /* --- 2. FLEXIBLE FLOW (No Overlapping) --- */
        #content-area { flex: 1; width: 100%; padding: 20px; box-sizing: border-box; position: relative; }
        #content-area > * { position: relative !important; display: block !important; width: 100% !important; margin-bottom: 20px; clear: both; }

        /* --- 3. RESPONSIVE RULES --- */
        @media (max-width: 980px) { header h1 { font-size: 1.2rem; } #content-area { padding: 10px; } }
        @media (min-width: 1600px) { #content-area { max-width: 1440px; margin: 0 auto; } }

        /* --- 4. NEWS MODAL STYLES (New) --- */
        .news-modal {
            display: none; 
            position: fixed; 
            z-index: 9999; 
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.9);
            backdrop-filter: blur(8px);
        }
        .modal-content {
            background-color: #1f1f1f;
            color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 0 20px #00ff00;
            border: 1px solid #333;
        }
        .close-modal {
            position: sticky;
            top: 0;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            color: #00ff00;
        }
        #modalBody { 
            line-height: 1.6; 
            white-space: pre-wrap; 
            font-size: 1.1rem;
            color: #ddd;
        }
    </style>
</head>
<body>

<div class="my-perfect-layout">
    <header><h1>Clay County Portal</h1></header>
    
    <div id="content-area">
        </div>

    <footer>Â© 2026 Clay County</footer>
</div>

<div id="storyModal" class="news-modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeStory()">&times;</span>
        <h2 id="modalTitle" style="color:#00ff00;"></h2>
        <hr style="border:0; border-top:1px solid #333; margin:20px 0;">
        <div id="modalBody"></div>
    </div>
</div>

<script>
// Logic to handle Pop-out Story
function openStory(title, content) {
    document.getElementById('modalTitle').innerText = title;
    document.getElementById('modalBody').innerText = content;
    document.getElementById('storyModal').style.display = "block";
    document.body.style.overflow = "hidden"; // Stop scrolling background
}

function closeStory() {
    document.getElementById('storyModal').style.display = "none";
    document.body.style.overflow = "auto"; // Enable scrolling background
}

// Close modal if user clicks outside the box
window.onclick = function(event) {
    const modal = document.getElementById('storyModal');
    if (event.target == modal) { closeStory(); }
}

async function loadPortal() {
    const contentDiv = document.getElementById('content-area');
    
    try {
        const urlParams = new URLSearchParams(window.location.search);
        const label = urlParams.get('type') || 'default';

        if (label.includes('gas')) {
            const fuelUrl = "https://kfruti88.github.io/Clay-County-Fuel/gas_prices.json";
            const res = await fetch(fuelUrl);
            const fuelData = await res.json();
            contentDiv.innerHTML = `<h2>Live Gas Prices</h2><div id="gas-board"></div>`;
            renderFuelBoard(fuelData); 
        } 
        else {
            // Updated News Logic to use the Modal instead of just an Iframe if you prefer direct rendering
            // For now, keeping your Iframe logic as you had it:
            contentDiv.innerHTML = `<iframe src="https://kfruti88.github.io/clay-county-news/index.html" style="width:100%; height:1500px; border:none;"></iframe>`;
        }

    } catch (e) {
        contentDiv.innerHTML = `<div style="color:#ff4444; text-align:center; padding:40px;">
            <strong>Sync Error:</strong> ${e.message}
        </div>`;
    }
}

function renderFuelBoard(data) {
    const board = document.getElementById('gas-board');
    if (!board) return;
    // Gas rendering logic here
}

loadPortal();
</script>
</body>
</html>
